@model IEnumerable<Dist23MVC.Models.MeetingsList>
@using Kendo.Mvc.UI;

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .k-grid {
        font-family: "DejaVu Sans", "Arial", sans-serif;
        font-size: 0.9em;
    }
</style>
<script type="text/javascript" language="javascript" src="@Url.Content("~/Scripts/kendo/pako_deflate.min.js")"></script>
<div>
    <div id="membersGrid">
        @(Html.Kendo().Grid<Dist23MVC.Models.MeetingsList>()
        .Name("grid")
        .Columns(columns =>
        {
            columns.Bound(p => p.Day).HeaderTemplate("<label for='Day'>Day</label>");
            columns.Bound(p => p.Time).HeaderTemplate("<label for='Time'>Time</label>");
            columns.Bound(p => p.type).HeaderTemplate("<label for='type'>Type</label>");
            columns.Bound(p => p.topic).HeaderTemplate("<label for='topic'>Topic</label>");
            columns.Bound(p => p.aaGroup).HeaderTemplate("<label for='aaGroup'>Group</label>");
            columns.Bound(p => p.location).HeaderTemplate("<label for='location'>Location</label>");
            columns.Bound(p => p.city).HeaderTemplate("<label for='city'>City</label>");
            columns.Bound(p => p.MapURL).ClientTemplate("<a href='#=MapURL#' target='_blank'>View Map</a>").HeaderTemplate("<label for='gender'>Maps</label>");
        })
               .ToolBar(tools => tools.Excel())
                 .Excel(excel => excel
                     .FileName("Members.xlsx")
                     .Filterable(true)
                     .AllPages(true)
                 )
                 .ToolBar(tools => tools.Pdf())
                   .Pdf(pdf => pdf
                   .AllPages()
                   .FileName("MeetingList.pdf")
                    )
        .Groupable()
        .Sortable()
        .ColumnMenu()
        .Filterable()
        .Scrollable(h => h.Height("auto"))
        .DataSource(dataSource => dataSource
            .Ajax()
            .Read(read => read.Action("Meetings_Read", "Meetings"))))
    </div>
    @Html.ActionLink("Download","DownloadMeetings","Meetings")
</div>
